# RestorePoint Demo
# Provision and Deploy a simple HTML web application

trigger: none

pool: Default

stages:
- stage: provisionAKS
  displayName: Provision an AKS cluster
  jobs:
    - job: dependencies
      displayName: Install Dependencies
      steps:
      - task: TerraformInstaller@0
        inputs:
          terraformVersion: 'latest'
        
      - task: KubectlInstaller@0
        inputs:
          kubectlVersion: 'latest'
      
    - job: provision
      displayName: Provision AKS cluster
      steps:
      - script: terraform init
        displayName: Terraform Initialization
      
      - script: terraform plan
        displayName: Terraform Plan

- stage: deployApp
  displayName: Deploy Nginx deployment
  dependsOn: provisionAKS
  jobs:
    - job: deploy
      displayName: Deploy Manifest files
      steps:
        - script: echo "Deploying Steps here"
          displayName: Deploy Nginx
